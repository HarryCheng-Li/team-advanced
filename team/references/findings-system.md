# Findings 系统 - 技术发现记录

> 版本: 1.0.0 | 更新时间: 2026-02-20
> 来源: Planning with Files + Team Skill 扩展

---

## 概述

Findings 系统用于记录任务执行过程中的技术发现，防止重要信息在上下文窗口压缩时丢失。

### 核心理念

```
┌─────────────────────────────────────────────────────┐
│           RAM vs Disk 类比                          │
├─────────────────────────────────────────────────────┤
│  Context Window = RAM (易失、有限)                  │
│  Filesystem     = Disk (持久、无限)                 │
│                                                     │
│  → 任何重要信息都立即写入"磁盘"                     │
└─────────────────────────────────────────────────────┘
```

---

## 核心文件

| 文件 | 用途 | 更新时机 | 位置 |
|------|------|----------|------|
| `findings.md` | 技术发现、API 文档摘要 | 每次重要发现后 | `.claude/findings/` |
| `decisions.md` | 架构决策记录 (ADR) | 每次重大决策后 | `.claude/findings/` |
| `task_plan.md` | 阶段进度、决策日志 | 每阶段完成后 | `.claude/plans/` |

---

## 2-Action 规则 ⭐ 核心

```
┌─────────────────────────────────────────────────────┐
│              2-Action 规则                          │
├─────────────────────────────────────────────────────┤
│  每 2 次搜索/浏览/查看操作后:                        │
│    1. 提取关键发现                                  │
│    2. 写入 findings.md                             │
│                                                     │
│  目的: 防止视觉/多模态信息在上下文压缩时丢失        │
└─────────────────────────────────────────────────────┘
```

### 适用场景

- ✅ 技术尽调搜索后
- ✅ 阅读 API 文档后
- ✅ 浏览代码示例后
- ✅ 研究问题解决方案后
- ❌ 简单查询（不需要记录）

---

## 文件模板

### findings.md 模板

```markdown
# 技术发现

> 创建时间: <YYYY-MM-DD>
> 任务: <任务描述>

## API/库 研究
| 日期 | 主题 | 发现 | 来源 |
|------|------|------|------|
| 2026-02-20 | JWT 认证 | 使用 jsonwebtoken 库，支持 RS256 | npm docs |
| | | | |

## 代码模式
| 模式 | 适用场景 | 示例文件 |
|------|----------|----------|
| Repository Pattern | 数据访问层 | src/repositories/ |
| | | |

## 已知问题
| 问题 | 状态 | 解决方案 |
|------|------|----------|
| MySQL 8.0 认证问题 | 已解决 | 使用 mysql_native_password |
| | | |

## 最佳实践
1. [从搜索中提取的最佳实践]
2. [从文档中学到的要点]

## 参考链接
- [相关文档 URL]
- [相关示例 URL]
```

### decisions.md 模板

```markdown
# 架构决策记录 (ADR)

> 创建时间: <YYYY-MM-DD>

## ADR-001: <决策标题>

### 日期
YYYY-MM-DD

### 状态
提议 | 已接受 | 已废弃 | 已替代

### 背景
<描述导致此决策的情况>

### 决策
<描述决策内容>

### 理由
<解释为什么选择这个方案>

### 后果
<描述决策的影响，包括正面和负面>

### 替代方案
<列出被拒绝的其他方案及原因>
```

---

## 与 Team Skill 集成

### Phase 1: 技术尽调

tech-scout 在执行搜索时：

```
1. 执行搜索操作
2. 评估搜索结果
3. [每 2 次操作] → 写入 findings.md
4. 继续搜索或完成
```

**tech-scout prompt 增强**：

```markdown
## 记录规则 (2-Action 规则)

每 2 次搜索/浏览操作后，将关键发现保存到 .claude/findings/findings.md

格式:
### [<主题>] - <时间>
- 发现 1: <内容>
- 发现 2: <内容>
- 来源: <URL 或文件路径>
```

### Phase 4: 架构决策

architect 在做出重大决策时：

```
1. 分析选项
2. 做出决策
3. 记录到 decisions.md (ADR 格式)
4. 继续执行
```

### Phase 8: 持续学习

任务完成后：

```
1. 读取 findings.md
2. 提取可复用的知识点
3. 转化为 instinct
4. 存储到组织记忆库
```

---

## Read vs Write 决策矩阵

| 场景 | 读 | 写 |
|------|----|----|
| 开始新任务 | 读取现有 findings | - |
| 搜索后 | - | 写入发现 |
| 决策前 | 读取相关 decisions | - |
| 决策后 | - | 写入 ADR |
| 遇到错误 | 读取已知问题 | 写入错误和解决方案 |
| 任务完成 | - | 整理归档 |

---

## 实施检查清单

### 初始化
- [ ] 创建 `.claude/findings/` 目录
- [ ] 创建 `findings.md` 初始文件
- [ ] 创建 `decisions.md` 初始文件

### 执行中
- [ ] 每 2 次搜索后检查是否需要写入
- [ ] 重要决策记录到 decisions.md
- [ ] 错误和解决方案记录到已知问题

### 完成后
- [ ] 整理 findings.md，去除过时内容
- [ ] 归档到 `.claude/findings/archive/<date>/`
- [ ] 提取知识点到 instinct

---

## 示例

### 搜索记录示例

```markdown
### [OAuth 2.0 集成] - 2026-02-20 14:30

- 发现 1: 推荐使用 Authorization Code + PKCE 流程
- 发现 2: token 有效期建议设置为 15 分钟
- 发现 3: refresh token 存储需要加密
- 来源: https://oauth.net/2/grant-types/authorization-code/
```

### ADR 示例

```markdown
## ADR-001: 使用 JWT 进行身份认证

### 日期
2026-02-20

### 状态
已接受

### 背景
系统需要无状态的身份认证机制，支持分布式部署

### 决策
使用 JWT (JSON Web Token) 进行身份认证

### 理由
1. 无状态，易于横向扩展
2. 标准化，有成熟的库支持
3. 可携带用户信息，减少数据库查询

### 后果
- 正面: 简化了认证流程，支持分布式
- 负面: token 无法主动撤销，需要额外的黑名单机制

### 替代方案
- Session: 需要共享存储，增加复杂度
- API Key: 不适合用户认证场景
```

---

## 参考资源

- [Planning with Files GitHub](https://github.com/OthmanAdi/planning-with-files)
- [Manus Context Engineering](https://www.aikux.ai)
